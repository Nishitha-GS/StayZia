<% layout("/layout/boilerplate") %>
<style>
    #filters{
        display:flex;
        flex-wrap:wrap;
        align-items: center;
    }
    .filter{
        margin-right:2rem;
        margin-top:2rem;
        font-size: 0.85rem;
        text-align:center;  
        opacity:0.7;    
    }
    .filter:hover{
        opacity:1;
        cursor:pointer;
    }
    .active-filter{
        border:2px solid #dc3545;
        background-color: #f8d7da;
        font-size: large;
    }
    a{
        color:#000;
    }
    .tax-info{
        display:none;
    }
    .tax-toggle{
        border:1px solid black;
        border-radius:15px;
        height:3.5rem;
        display:flex;
        align-items: center;
        padding:1rem;
        margin-left:6rem;
    }
</style>
    <button class="btn btn-outline-dark d-md-none mb-3 mt-3" type="button" data-bs-toggle="collapse" data-bs-target="#filtersCollapse" aria-expanded="false" aria-controls="filtersCollapse">
        ☰ Categories
        </button>
    <div id="filters" class="collapse d-none d-md-flex mb-4">
        <div class="filter">
            <a href="/listings?category=Trending" class="<%= category === 'Trending'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-fire"></i>
             </a>   
            <p>Trending </p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Rooms"class="<%= category === 'Rooms'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-bed"></i>
            </a>    
            <p>Rooms</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Iconic cities" class="<%= category === 'Iconic cities'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-city"></i>
             </a>   
            <p>Iconic cities</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Mountains" class="<%= category === 'Mountains'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-mountain"></i>
             </a>   
            <p>Mountains</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=castles" class="<%= category === 'castles'?'active-filter rounded-5':''%>">
            <div><i class="fa-brands fa-fort-awesome"></i>
             </a>   
            <p>castles</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Arctic" class="<%= category === 'Arctic'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-snowman"></i>
             </a>   
            <p>Arctic</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Camping" class="<%= category === 'Camping'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-campground"></i>
             </a>
            <p>Camping </p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Farms" class="<%= category === 'Farms'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-cow"></i>   
                 </a> 
            <p>Farms</p></div>
            
        </div>
        <div class="filter">
            <a href="/listings?category=Swimming" class="<%= category === 'Swimming'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-person-swimming"></i>   
                 </a> 
            <p>Swimming</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Beach" class="<%= category === 'Beach'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-umbrella-beach"></i> 
                 </a> 
            <p>Beach</p></div>
        </div>
        <div class="filter">
            <a href="/listings?category=Boat" class="<%= category === 'Boat'?'active-filter rounded-5':''%>">
            <div><i class="fa-solid fa-sailboat"></i>  
                 </a> 
            <p>Boat</p></div>
        </div>
        <div class="tax-toggle">
            <div class="form-check-reverse form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
            <label class="form-check-label" for="switchCheckDefault">Display total after taxes</label>
        </div>
        </div>

    </div>


    <h2><%= category ? `Places in ${category}` : "All Listings" %></h2>
    <div class="row row-cols-lg-3 row-cols-lg-2 row-cols-sm-1">
    <% for(let listing of allListings) {%>
        <a href="/listings/<%= listing._id %>" class="listing-link">
                 <div class="card  listing-card col">
                    <img src="<%= listing.image.url %>" class="card-img-top" alt="listing_item" style="height: 20rem;">
                    <div class="card-img-overlay"></div>
                <div class="card-body">
                    <h5 class="card-title" required><%= listing.title %></h5>
                    <p class="card-text" required>₹<%= listing.price?listing.price.toLocaleString("en-IN"):"Price not available" %>/night <i class="tax-info"> &nbsp; &nbsp; +18% GST</i></p>
                </div>
            </div>
        </a>
    <% } %>
    </div>


<script>
//for switch button
let taxSwitch=document.getElementById("switchCheckDefault");
taxSwitch.addEventListener("click",()=>{
    let taxInfo=document.getElementsByClassName("tax-info");
    for(info of taxInfo){
        if(info.style.display !="inline"){
            info.style.display= "inline";
        }else{
            info.style.display="none";
        }
    }
});

</script>


